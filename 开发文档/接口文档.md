# 📚 文章管理系统接口文档

> Version: 1.0.0  
> Last Updated: 2024-09-24  
> API Base URL: http://localhost:8080/api

## 🎯 接口设计原则

### 1. 数据返回分析方法

**基于业务需求分析返回数据结构：**

```javascript
// 文章列表场景 - 需要展示卡片信息
{
  "id": 1,
  "title": "文章标题",
  "summary": "文章摘要",
  "coverImage": "封面图URL",
  "author": {
    "id": 1,
    "nickname": "作者昵称",
    "avatar": "头像URL"
  },
  "category": {
    "id": 1,
    "name": "分类名称",
    "color": "#1890ff"
  },
  "tags": [
    {"id": 1, "name": "Java", "color": "#f50"}
  ],
  "status": 1, // 0-草稿 1-已发布 2-已下架
  "viewCount": 1234,
  "likeCount": 56,
  "commentCount": 23,
  "publishTime": "2024-09-24T10:00:00Z",
  "createTime": "2024-09-24T09:00:00Z"
}

// 文章详情场景 - 需要完整内容
{
  // 包含列表字段 +
  "content": "文章Markdown内容",
  "keywords": "SEO关键词",
  "description": "SEO描述",
  "isTop": false,
  "isRecommend": true,
  "articleType": 1, // 1-原创 2-转载 3-翻译
  "originalUrl": "原文链接"
}
```

### 2. 数据库表结构对应关系

```sql
-- 数据库表结构参考
articles 表字段：
- id, title, content, summary, cover_image
- author_id, category_id, status
- view_count, like_count, comment_count
- is_top, is_recommend, article_type
- publish_time, create_time, update_time

-- 关联表：
- article_tags (文章标签多对多)
- users (作者信息)
- categories (分类信息)
- tags (标签信息)
```

---

## 📋 文章管理接口

### 1. 文章列表查询

**接口地址:** `GET /articles`

**请求参数:**
```javascript
{
  "page": 1,           // 页码，默认1
  "size": 10,          // 每页数量，默认10
  "keyword": "",       // 搜索关键词（标题+内容）
  "categoryId": 1,     // 分类ID筛选
  "tagIds": [1,2],     // 标签ID数组筛选
  "status": 1,         // 状态筛选（0-草稿 1-已发布 2-已下架）
  "authorId": 1,       // 作者ID筛选
  "sort": "publishTime", // 排序字段
  "order": "desc"      // 排序方向（asc/desc）
}
```

**响应数据:**
```javascript
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "records": [
      {
        "id": 1,
        "title": "Spring Boot 3.0新特性详解",
        "summary": "深入解析Spring Boot 3.0的重要更新...",
        "coverImage": "https://example.com/cover.jpg",
        "author": {
          "id": 1,
          "nickname": "技术小哥",
          "avatar": "https://example.com/avatar.jpg"
        },
        "category": {
          "id": 1,
          "name": "后端开发",
          "color": "#1890ff"
        },
        "tags": [
          {"id": 1, "name": "Java", "color": "#f50"},
          {"id": 2, "name": "Spring Boot", "color": "#2db7f5"}
        ],
        "status": 1,
        "viewCount": 1234,
        "likeCount": 56,
        "commentCount": 23,
        "isTop": false,
        "isRecommend": true,
        "publishTime": "2024-09-24T10:00:00Z",
        "createTime": "2024-09-24T09:00:00Z"
      }
    ],
    "total": 100,
    "current": 1,
    "size": 10,
    "pages": 10
  }
}
```

### 2. 文章详情查询

**接口地址:** `GET /articles/{id}`

**路径参数:**
- `id`: 文章ID

**响应数据:**
```javascript
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "id": 1,
    "title": "Spring Boot 3.0新特性详解",
    "content": "# Spring Boot 3.0 新特性\n\n## 1. Native Image支持...",
    "summary": "深入解析Spring Boot 3.0的重要更新...",
    "coverImage": "https://example.com/cover.jpg",
    "author": {
      "id": 1,
      "nickname": "技术小哥",
      "avatar": "https://example.com/avatar.jpg",
      "bio": "Java后端开发工程师"
    },
    "category": {
      "id": 1,
      "name": "后端开发",
      "description": "Java, Spring Boot等后端技术"
    },
    "tags": [
      {"id": 1, "name": "Java", "color": "#f50"},
      {"id": 2, "name": "Spring Boot", "color": "#2db7f5"}
    ],
    "status": 1,
    "viewCount": 1235, // 阅读后+1
    "likeCount": 56,
    "commentCount": 23,
    "isTop": false,
    "isRecommend": true,
    "articleType": 1,
    "originalUrl": null,
    "keywords": "Spring Boot, Java, 后端开发",
    "description": "Spring Boot 3.0新特性详解",
    "publishTime": "2024-09-24T10:00:00Z",
    "createTime": "2024-09-24T09:00:00Z",
    "updateTime": "2024-09-24T11:00:00Z"
  }
}
```

### 3. 创建文章

**接口地址:** `POST /articles`
**权限要求:** 需要登录（USER/ADMIN角色）

**请求体:**
```javascript
{
  "title": "文章标题",
  "content": "# 文章内容\n\nMarkdown格式的内容...",
  "summary": "文章摘要（可选，如果不提供会自动从content提取）",
  "coverImage": "封面图URL（可选）",
  "categoryId": 1,
  "tagIds": [1, 2, 3],
  "status": 0, // 0-草稿 1-发布
  "isTop": false,
  "isRecommend": false,
  "articleType": 1, // 1-原创 2-转载 3-翻译
  "originalUrl": "原文链接（转载/翻译时必填）",
  "keywords": "SEO关键词",
  "description": "SEO描述"
}
```

**响应数据:**
```javascript
{
  "code": 200,
  "message": "创建成功",
  "data": {
    "id": 10,
    "title": "文章标题",
    // ... 完整文章信息
  }
}
```

### 4. 更新文章

**接口地址:** `PUT /articles/{id}`
**权限要求:** 作者本人或管理员

**请求体:** 与创建文章相同

**响应数据:** 与创建文章响应相同

### 5. 删除文章

**接口地址:** `DELETE /articles/{id}`
**权限要求:** 作者本人或管理员

**响应数据:**
```javascript
{
  "code": 200,
  "message": "删除成功",
  "data": null
}
```

### 6. 批量操作文章

**接口地址:** `POST /articles/batch`
**权限要求:** 管理员

**请求体:**
```javascript
{
  "action": "updateStatus", // updateStatus/delete/setTop/setRecommend
  "articleIds": [1, 2, 3],
  "params": {
    "status": 1, // 根据action不同传入相应参数
    "isTop": true
  }
}
```

---

## 🏷️ 分类管理接口

### 1. 获取分类列表

**接口地址:** `GET /categories`

**请求参数:**
```javascript
{
  "includeArticleCount": true // 是否包含文章数量统计
}
```

**响应数据:**
```javascript
{
  "code": 200,
  "message": "查询成功",
  "data": [
    {
      "id": 1,
      "name": "后端开发",
      "description": "Java, Spring Boot等后端技术",
      "icon": "backend",
      "sortOrder": 1,
      "articleCount": 25, // 如果includeArticleCount=true
      "createTime": "2024-01-01T00:00:00Z"
    }
  ]
}
```

### 2. 创建分类

**接口地址:** `POST /categories`
**权限要求:** 管理员

### 3. 更新分类

**接口地址:** `PUT /categories/{id}`
**权限要求:** 管理员

### 4. 删除分类

**接口地址:** `DELETE /categories/{id}`
**权限要求:** 管理员

---

## 🏷️ 标签管理接口

### 1. 获取标签列表

**接口地址:** `GET /tags`

### 2. 创建标签

**接口地址:** `POST /tags`

### 3. 获取热门标签

**接口地址:** `GET /tags/hot`

**响应数据:**
```javascript
{
  "code": 200,
  "message": "查询成功", 
  "data": [
    {
      "id": 1,
      "name": "Java",
      "color": "#f50",
      "articleCount": 156,
      "useCount": 234
    }
  ]
}
```

---

## 📊 统计接口

### 1. 文章统计

**接口地址:** `GET /articles/stats`
**权限要求:** 需要登录

**响应数据:**
```javascript
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "total": 100,      // 总文章数
    "published": 85,   // 已发布
    "draft": 15,       // 草稿
    "totalViews": 50000, // 总浏览量
    "totalLikes": 2500,  // 总点赞数
    "totalComments": 800 // 总评论数
  }
}
```

### 2. 作者文章列表

**接口地址:** `GET /articles/my`
**权限要求:** 需要登录

**请求参数:** 与文章列表查询相同

---

## 🎨 页面原型设计

### 1. 文章列表页 (`/articles`)

```
┌─────────────────────────────────────────────────┐
│ 🏠 博客首页 > 📚 文章列表                          │
├─────────────────────────────────────────────────┤
│ 🔍 [搜索框] 📂分类筛选▼ 🏷️标签筛选▼ [搜索] [重置]  │
├─────────────────────────────────────────────────┤
│ 📄 排序：最新发布▼ 显示：卡片视图▼ [+ 写文章]        │
├─────────────────────────────────────────────────┤
│ ┌─────────────────────┐ ┌─────────────────────┐  │
│ │ 📷 [封面图]           │ │ 📷 [封面图]           │  │
│ │ 📖 文章标题           │ │ 📖 文章标题           │  │
│ │ 👤 作者名 📅 发布时间  │ │ 👤 作者名 📅 发布时间  │  │
│ │ 📝 文章摘要...       │ │ 📝 文章摘要...       │  │
│ │ 🏷️ [Java] [Spring]   │ │ 🏷️ [React] [前端]     │  │
│ │ 👁️ 999 ❤️ 66 💬 23    │ │ 👁️ 888 ❤️ 45 💬 12    │  │
│ │ [阅读全文] [编辑] [删除]│ │ [阅读全文] [编辑] [删除]│  │
│ └─────────────────────┘ └─────────────────────┘  │
├─────────────────────────────────────────────────┤
│             📄 分页组件 ← 1 2 3 4 5 →             │
└─────────────────────────────────────────────────┘
```

**页面功能按钮：**
- ✅ **[+ 写文章]** - 跳转到文章编辑页
- ✅ **[阅读全文]** - 跳转到文章详情页
- ✅ **[编辑]** - 跳转到文章编辑页（仅作者/管理员可见）
- ✅ **[删除]** - 删除文章确认弹窗（仅作者/管理员可见）
- ✅ **[搜索]** - 根据条件筛选文章
- ✅ **[重置]** - 清空筛选条件

### 2. 文章详情页 (`/articles/[id]`)

```
┌─────────────────────────────────────────────────┐
│ 🏠 博客首页 > 📂 后端开发 > 📖 文章标题              │
├─────────────────────────────────────────────────┤
│                  📖 文章标题                      │
│              👤 作者名 📅 2024-09-24              │
│              📂 后端开发 🏷️ [Java] [Spring]       │
│              👁️ 1234 ❤️ 56 💬 23 📚 收藏          │
│              [👍 点赞] [💬 评论] [📤 分享] [✏️ 编辑] │
├─────────────────────────────────────────────────┤
│                                                 │
│             📷 [文章封面图]                      │
│                                                 │
│   # 文章内容                                    │
│                                                 │
│   这里是文章的Markdown内容，会被渲染成HTML...     │
│                                                 │
│   ## 小标题                                     │
│                                                 │
│   内容段落...                                   │
│                                                 │
├─────────────────────────────────────────────────┤
│ 📝 评论区 (23条评论)                             │
│ ┌─────────────────────────────────────────────┐  │
│ │ 👤 用户名 📅 2024-09-24 12:30               │  │
│ │ 很棒的文章，学到了很多！                     │  │
│ │ [❤️ 5] [💬 回复] [举报]                      │  │
│ └─────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────┤
│ 📝 发表评论                                     │
│ ┌─────────────────────────────────────────────┐  │
│ │ [评论输入框]                                │  │
│ │                                             │  │
│ │                        [取消] [发表评论]     │  │
│ └─────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
```

**页面功能按钮：**
- ✅ **[👍 点赞]** - 点赞/取消点赞文章
- ✅ **[💬 评论]** - 跳转到评论区
- ✅ **[📤 分享]** - 分享文章链接
- ✅ **[✏️ 编辑]** - 编辑文章（仅作者/管理员可见）
- ✅ **[📚 收藏]** - 收藏/取消收藏文章
- ✅ **[发表评论]** - 提交评论

### 3. 文章编辑页 (`/editor` 或 `/articles/[id]/edit`)

```
┌─────────────────────────────────────────────────┐
│ ✏️ 文章编辑                      [预览] [保存草稿] [发布] │
├─────────────────────────────────────────────────┤
│ 标题：[________________________文章标题_________] │
│ 分类：[后端开发 ▼] 标签：[+ 添加标签] [Java] [x] [Spring] [x] │
│ 封面：[选择图片] 或 [输入URL________________________] │
│ 类型：●原创 ○转载 ○翻译 原文链接：[_______________] │
│ SEO： 关键词：[Java,Spring Boot,后端____________]   │
│       描述：[_________________________________]   │
├─────────────────────────────────────────────────┤
│ ┌─────────────────┐ │ ┌─────────────────────────┐ │
│ │ # 编辑区         │ │ │ 📖 预览区                │ │
│ │                 │ │ │                         │ │
│ │ # 文章标题       │ │ │ # 文章标题               │ │
│ │                 │ │ │                         │ │
│ │ ## 小标题        │ │ │ ## 小标题                │ │
│ │                 │ │ │                         │ │
│ │ 内容...         │ │ │ 内容...                 │ │
│ │                 │ │ │                         │ │
│ └─────────────────┘ │ └─────────────────────────┘ │
├─────────────────────────────────────────────────┤
│ 📊 字数：1234 📅 最后保存：2024-09-24 12:30      │
│ 💡 设置：□置顶 □推荐 发布时间：[立即发布 ▼]         │
└─────────────────────────────────────────────────┘
```

**页面功能按钮：**
- ✅ **[预览]** - 切换预览模式
- ✅ **[保存草稿]** - 保存为草稿状态
- ✅ **[发布]** - 发布文章
- ✅ **[选择图片]** - 上传封面图片
- ✅ **[+ 添加标签]** - 添加文章标签
- ✅ **[删除标签 x]** - 移除标签

### 4. 我的文章页 (`/my/articles`)

```
┌─────────────────────────────────────────────────┐
│ 📝 我的文章                                     │
├─────────────────────────────────────────────────┤
│ 📊 统计：总计50篇 ✅已发布42篇 📝草稿8篇 👁️总浏览12.3k │
├─────────────────────────────────────────────────┤
│ 🔍 [搜索我的文章] 状态：[全部▼] [+ 写新文章] [批量操作▼] │
├─────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────┐  │
│ │☑️ 📖 Spring Boot 3.0新特性   ✅已发布 📅2024-09-20 │  │
│ │   👁️1234 ❤️56 💬23          [编辑] [删除] [统计]  │  │
│ ├─────────────────────────────────────────────┤  │
│ │☑️ 📖 React性能优化实践       📝草稿   📅2024-09-24 │  │
│ │   👁️0 ❤️0 💬0              [编辑] [发布] [删除]  │  │
│ └─────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────┤
│             📄 分页组件 ← 1 2 3 4 5 →             │
└─────────────────────────────────────────────────┘
```

**页面功能按钮：**
- ✅ **[+ 写新文章]** - 创建新文章
- ✅ **[编辑]** - 编辑文章
- ✅ **[删除]** - 删除文章
- ✅ **[发布]** - 发布草稿文章
- ✅ **[统计]** - 查看文章详细统计
- ✅ **[批量操作]** - 批量删除/发布等操作

---

## 🔧 技术实现要点

### 1. 前端状态管理
```javascript
// 使用Zustand管理文章相关状态
const useArticleStore = create((set) => ({
  articles: [],
  currentArticle: null,
  loading: false,
  pagination: { current: 1, total: 0, size: 10 },
  filters: { keyword: '', categoryId: null, tagIds: [] }
}))
```

### 2. 图片上传处理
```javascript
// 封面图片上传组件
<ImageUpload 
  accept="image/*"
  maxSize={5 * 1024 * 1024} // 5MB
  onUpload={handleImageUpload}
  preview={coverImage}
/>
```

### 3. Markdown编辑器集成
```javascript
// 使用@uiw/react-md-editor
import MDEditor from '@uiw/react-md-editor'

<MDEditor
  value={content}
  onChange={setContent}
  preview="edit"
  height={600}
  data-color-mode="light"
/>
```

### 4. 权限控制
```javascript
// 页面级权限控制
const ProtectedRoute = ({ children, requiredRole = 'USER' }) => {
  const { user, isAuthenticated } = useAuth()
  
  if (!isAuthenticated) return <Navigate to="/login" />
  if (requiredRole && user.role !== requiredRole) return <Forbidden />
  
  return children
}
```

---

## 🚀 开发优先级

### 第一阶段（核心功能）
1. ✅ 文章列表查询接口
2. ✅ 文章详情查询接口  
3. ✅ 文章创建接口
4. ✅ 分类标签获取接口
5. ✅ 基础的文章列表页面

### 第二阶段（编辑功能）
1. ✅ 文章编辑/更新接口
2. ✅ Markdown编辑器页面
3. ✅ 图片上传功能
4. ✅ 文章删除接口

### 第三阶段（高级功能）
1. ✅ 文章统计接口
2. ✅ 批量操作接口
3. ✅ 我的文章管理页面
4. ✅ 评论功能集成

---

## 📋 接口清单总结

| 功能模块 | 方法 | 路径 | 描述 | 状态 |
|---------|------|------|------|------|
| 文章 | GET | /articles | 文章列表查询 | ⏳待开发 |
| 文章 | GET | /articles/{id} | 文章详情查询 | ⏳待开发 |
| 文章 | POST | /articles | 创建文章 | ⏳待开发 |
| 文章 | PUT | /articles/{id} | 更新文章 | ⏳待开发 |
| 文章 | DELETE | /articles/{id} | 删除文章 | ⏳待开发 |
| 文章 | GET | /articles/my | 我的文章列表 | ⏳待开发 |
| 文章 | GET | /articles/stats | 文章统计 | ⏳待开发 |
| 文章 | POST | /articles/batch | 批量操作 | ⏳待开发 |
| 分类 | GET | /categories | 分类列表 | ⏳待开发 |
| 分类 | POST | /categories | 创建分类 | ⏳待开发 |
| 标签 | GET | /tags | 标签列表 | ⏳待开发 |
| 标签 | GET | /tags/hot | 热门标签 | ⏳待开发 |
| 标签 | POST | /tags | 创建标签 | ⏳待开发 |

**总计：13个核心接口需要开发**
